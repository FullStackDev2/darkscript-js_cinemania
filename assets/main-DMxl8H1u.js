import{a as B}from"./vendor-BWC8OeqA.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#checkbox"),t=localStorage.getItem("theme");if(t==="light"?document.body.classList.add("light-mode"):document.body.classList.remove("light-mode"),!e)return;e.checked=t==="light";function n(o){o.target.checked?(document.body.classList.add("light-mode"),localStorage.setItem("theme","light")):(document.body.classList.remove("light-mode"),localStorage.setItem("theme","dark"))}e.addEventListener("change",n,!1)});console.log("[header] header.js checking in");let c=null;function H(e){c||(c=document.createElement("div"),c.className="mobile-menu-overlay",c.addEventListener("click",e),document.body.appendChild(c))}function C(){c&&(c.remove(),c=null)}function N(e,t){t.classList.add("open"),e.setAttribute("aria-expanded","true"),H(()=>g(e,t)),document.body.style.overflow="hidden"}function g(e,t){t.classList.remove("open"),e&&e.setAttribute("aria-expanded","false"),C(),document.body.style.overflow=""}document.addEventListener("click",e=>{console.log("[header] Global click on:",e.target);const t=e.target.closest(".menu-open-btn");if(t){console.log("[header] Menu btn detected!");const o=document.querySelector(".mobile-menu");if(!o)return;console.log("[header] Menu toggle clicked"),o.classList.contains("open")?g(t,o):N(t,o);return}if(e.target.closest(".mobile-menu .nav-link")){const o=document.querySelector(".mobile-menu"),r=document.querySelector(".menu-open-btn");o&&o.classList.contains("open")&&setTimeout(()=>g(r,o),100)}});document.addEventListener("keydown",e=>{if(e.key==="Escape"){const t=document.querySelector(".mobile-menu"),n=document.querySelector(".menu-open-btn");t&&t.classList.contains("open")&&g(n,t)}});const _="98ff2d6267ceea8e039422b0f46fb813",x="https://api.themoviedb.org/3",d=B.create({baseURL:x,params:{api_key:_,language:"en-US"}}),L=async(e="day")=>{try{const{data:t}=await d.get(`/trending/movie/${e}`);return t.results}catch(t){throw console.error(`Trend filmler (${e}) alınamadı:`,t),t}},O=async(e,t=1,n="")=>{try{const{data:o}=await d.get("/search/movie",{params:{query:e,page:t,year:n}});return o}catch(o){throw console.error("Film araması başarısız:",o),o}},w=async e=>{try{const{data:t}=await d.get(`/movie/${e}`);return t}catch(t){throw console.error("Film detayları alınamadı:",t),t}},M=async e=>{try{const{data:t}=await d.get(`/movie/${e}/videos`);return t.results.filter(n=>n.site==="YouTube"&&n.type==="Trailer")}catch(t){throw console.error("Film fragmanı bulunamadı:",t),t}},q=async(e=1)=>{try{const{data:t}=await d.get("/movie/upcoming",{params:{page:e}});return t}catch(t){throw console.error("Gelecek filmler alınamadı:",t),t}},D=async()=>{try{const{data:e}=await d.get("/genre/movie/list");return e.genres}catch(e){throw console.error("Tür listesi alınamadı:",e),e}},f={getTrending:L,searchMovies:O,getMovieDetails:w,getMovieVideos:M,getUpcoming:q,getGenres:D};function j(e){return e[Math.floor(Math.random()*e.length)]}async function U(){const e=document.getElementById("hero-section");if(!e)return;const t=e.getAttribute("data-page");if(t==="dynamic")try{const n=await L("day");if(n&&n.length>0){const o=j(n);A(e,o)}else y(e)}catch(n){console.error("Hero yüklenirken hata:",n),y(e)}else t==="library"&&y(e)}document.addEventListener("DOMContentLoaded",()=>{U().catch(e=>console.error("initHero error:",e))});function A(e,t){const{title:n,overview:o,backdrop_path:r,vote_average:a,id:i}=t,s=()=>{const $="linear-gradient(90deg, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.65) 20%, rgba(0,0,0,0.0) 60%)";let p="w780";window.innerWidth>=1280?p="original":window.innerWidth>=768&&(p="w1280");let u="";if(r)u=`https://image.tmdb.org/t/p/${p}${r}`;else{const h=["../../images/background/desktop-1.jpg","../../images/background/desktop-2.jpg","../../images/background/mobile-1.jpg"],v=h[Math.floor(Math.random()*h.length)];try{u=new URL(v,import.meta.url).href}catch{u=`/src/images/background/${v.split("/").pop()}`}}e.style.backgroundImage=`${$}, url(${u})`,e.style.backgroundPosition="right center"};s(),new MutationObserver(s).observe(document.body,{attributes:!0,attributeFilter:["class"]}),window.addEventListener("resize",s),e.innerHTML=`
    <div class="container hero-content">
      <h1 class="hero-title">${n}</h1>
      <div class="hero-rating">${a.toFixed(1)}</div> 
      <p class="hero-description">${o.slice(0,220)}...</p> 
      <div class="hero-btns">
        <button type="button" class="btn-primary" id="watch-trailer">Watch trailer</button>
        <button type="button" class="btn-secondary" id="more-details">More details</button>
      </div>
    </div>
  `,document.getElementById("watch-trailer").addEventListener("click",()=>{window.dispatchEvent(new CustomEvent("openTrailerModal",{detail:{movieId:i}}))}),document.getElementById("more-details").addEventListener("click",()=>{window.dispatchEvent(new CustomEvent("openDetailsModal",{detail:{movie:t}}))})}function y(e){e.classList.add("hero-default"),e.innerHTML=`
    <div class="container hero-content">
      <h1 class="hero-title">Let’s Make Your Own Cinema</h1>
      <p class="hero-description">Is a guide to creating a personalized movie theater experience. You'll need a projector, screen, and speakers. </p>
      <button type="button" class="btn-primary" id="go-catalog">Get Started</button>
    </div>
  `;const t=["../../images/background/desktop-1.jpg","../../images/background/desktop-2.jpg","../../images/background/mobile-1.jpg"],n=t[Math.floor(Math.random()*t.length)];let o;try{o=new URL(n,import.meta.url).href}catch{o=`/src/images/background/${n.split("/").pop()}`}const r="linear-gradient(90deg, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.65) 20%, rgba(0,0,0,0.0) 60%)";e.style.backgroundImage=`${r}, url(${o})`,e.style.backgroundPosition="right center",document.getElementById("go-catalog").addEventListener("click",()=>{window.location.href="./catalog.html"})}async function F(){try{const e=await f.getGenres(),n=(await f.getUpcoming()).results[0],o=n.genre_ids.map(i=>{var s;return(s=e.find(l=>l.id===i))==null?void 0:s.name}).filter(i=>i).slice(0,2).join(", ");document.getElementById("movieTitle").textContent=n.title,document.getElementById("movieGenre").textContent=o||"Drama",document.getElementById("movieDate").textContent=n.release_date.split("-")[0],document.getElementById("heroBackdrop").src=`https://image.tmdb.org/t/p/original${n.poster_path}`;const r=document.getElementById("movieRating"),a=Math.round(n.vote_average/2);r.innerHTML="★".repeat(a)+"☆".repeat(5-a)}catch(e){console.error("Yükleme hatası:",e)}}F();const P=document.getElementById("openTeamModal"),R=document.getElementById("closeTeamModal"),m=document.getElementById("teamModal");P.addEventListener("click",()=>{m.style.display="flex"});R.addEventListener("click",()=>{m.style.display="none"});m.addEventListener("click",e=>{e.target===m&&(m.style.display="none")});const E="myLibrary";function b(){try{const e=localStorage.getItem(E);return e?JSON.parse(e):[]}catch(e){return console.error("localStorage read error",e),[]}}function I(e){try{localStorage.setItem(E,JSON.stringify(e))}catch(t){console.error("localStorage write error",t)}}function k(e){return b().some(n=>Number(n.id)===Number(e))}function Y(e){const t=b();t.some(n=>Number(n.id)===Number(e.id))||(t.push(e),I(t))}function G(e){let t=b();t=t.filter(n=>Number(n.id)!==Number(e)),I(t)}function z(){const e=document.createElement("div");e.className="modal-overlay",e.style.display="none";const t=document.createElement("div");t.className="modal",t.innerHTML=`
    <button class="modal-close" aria-label="close">×</button>
    <div class="modal-body">
      <div class="modal-content" id="modal-content"></div>
    </div>
  `,e.appendChild(t),document.body.appendChild(e);const n=t.querySelector(".modal-close");function o(){e.style.display="none";const r=e.querySelector("iframe");r&&(r.src="")}return e.addEventListener("click",r=>{r.target===e&&o()}),n.addEventListener("click",o),document.addEventListener("keydown",r=>{r.key==="Escape"&&e.style.display==="block"&&o()}),{overlay:e,modal:t,close:o}}const{overlay:T,modal:S}=z();async function K(e){const t=e.movieId||e.id,n=S.querySelector("#modal-content");n.innerHTML="<p>Yükleniyor...</p>",T.style.display="block";try{const o=await M(t);if(o&&o.length>0){const r=o.find(i=>i.site==="YouTube"),a=r?r.key:o[0].key;n.innerHTML=`<iframe class="trailer-iframe" src="https://www.youtube.com/embed/${a}" allowfullscreen></iframe>`}else n.innerHTML="<p>Fragman bulunamadı.</p>"}catch(o){console.error(o),n.innerHTML="<p>Fragman yüklenirken hata oluştu.</p>"}}async function W(e){const t=e.movie||e,n=S.querySelector("#modal-content");n.innerHTML="<p>Yükleniyor...</p>",T.style.display="block";try{const o=await w(t.id),r=o.poster_path?`https://image.tmdb.org/t/p/w500${o.poster_path}`:"",a=o.vote_average?o.vote_average.toFixed(1):"—",i=o.popularity?Math.round(o.popularity):"—",s=k(o.id);n.innerHTML=`
      <div class="modal-content">
        <div class="modal-poster"><img src="${r}" alt="${o.title}" style="width:100%;height:100%;object-fit:cover"></div>
        <div class="modal-info">
          <h2>${o.title}</h2>
          <div>Puan: ${a} · Popülerlik: ${i}</div>
          <p style="margin-top:8px;">${o.overview||"Açıklama yok."}</p>
          <div class="modal-actions">
            <button class="btn-primary" id="modal-library-btn">${s?"Remove from My Library":"Add to My Library"}</button>
          </div>
        </div>
      </div>
    `;const l=document.getElementById("modal-library-btn");l.addEventListener("click",()=>{k(o.id)?(G(o.id),l.textContent="Add to My Library"):(Y({id:o.id,title:o.title,poster_path:o.poster_path}),l.textContent="Remove from My Library")})}catch(o){console.error(o),n.innerHTML="<p>Detaylar yüklenirken hata oluştu.</p>"}}window.addEventListener("openTrailerModal",e=>K(e.detail));window.addEventListener("openDetailsModal",e=>W(e.detail));
//# sourceMappingURL=main-DMxl8H1u.js.map
